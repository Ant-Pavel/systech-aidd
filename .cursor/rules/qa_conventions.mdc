---
alwaysApply: false
---
# QA Conventions –¥–ª—è Systech AIDD Bot

## üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:** KISS, DRY, TDD (Red ‚Üí Green ‚Üí Refactor)
- –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
- –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞–∂–Ω–æ–µ –±–∏–∑–Ω–µ—Å-–ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –û–¥–∏–Ω —Ç–µ—Å—Ç = –æ–¥–Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

**–ß—Ç–æ –ù–ï —Ç–µ—Å—Ç–∏—Ä—É–µ–º:**
- ‚ùå –¢—Ä–∏–≤–∏–∞–ª—å–Ω—ã–µ –≥–µ—Ç—Ç–µ—Ä—ã/—Å–µ—Ç—Ç–µ—Ä—ã –±–µ–∑ –ª–æ–≥–∏–∫–∏
- ‚ùå –û—á–µ–≤–∏–¥–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è
- ‚ùå –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (aiogram, openai)
- ‚ùå –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø—Ä–æ—Å—Ç—ã–µ TypedDict —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚ùå –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (main.py, bot.py startup)

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º:**
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö (Pydantic Config)
- ‚úÖ –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏ edge cases
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ (—á–µ—Ä–µ–∑ Protocol)
- ‚úÖ Async –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ side effects

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞

**–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:**
```
tests/
‚îú‚îÄ‚îÄ unit/              # Unit-—Ç–µ—Å—Ç—ã –º–æ–¥—É–ª–µ–π (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
‚îú‚îÄ‚îÄ integration/       # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ)
‚îî‚îÄ‚îÄ conftest.py        # –û–±—â–∏–µ fixtures
```

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ:**
- –§–∞–π–ª—ã: `test_<module>.py`
- –ö–ª–∞—Å—Å—ã: `TestClassName`
- –§—É–Ω–∫—Ü–∏–∏: `test_<—á—Ç–æ_—Ç–µ—Å—Ç–∏—Ä—É–µ–º>_<–æ–∂–∏–¥–∞–µ–º—ã–π_—Ä–µ–∑—É–ª—å—Ç–∞—Ç>()`

## üß™ –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (AAA Pattern):**
1. Arrange - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–∫–æ–≤
2. Act - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
3. Assert - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
- Type hints –≤–µ–∑–¥–µ (—Ñ—É–Ω–∫—Ü–∏–∏, fixtures)
- Docstring –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞ (–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º)
- Async —Ç–µ—Å—Ç—ã –¥–ª—è async —Ñ—É–Ω–∫—Ü–∏–π
- AsyncMock –¥–ª—è async Protocol –º–µ—Ç–æ–¥–æ–≤
- MagicMock –¥–ª—è Protocol –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤

## üîß –ú–æ–∫–∏ –∏ Fixtures

**Protocol –º–æ–∫–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `MagicMock(spec=ProtocolName)`
- Async –º–µ—Ç–æ–¥—ã —á–µ—Ä–µ–∑ `AsyncMock`
- Fixtures –≤ `conftest.py` –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**Environment variables:**
- `monkeypatch.setenv()` –¥–ª—è —Ç–µ—Å—Ç–æ–≤ Pydantic Config
- `monkeypatch.delenv()` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

**Fixtures:**
- –°–æ–∑–¥–∞–≤–∞—Ç—å –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –ò–º–µ–Ω–æ–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω–æ (–±–µ–∑ `get_`, `make_` –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤)
- Type hints –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã

## üéØ –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (Pydantic):**
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è ‚Üí ValidationError
- –ì—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (min/max constraints)
- –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ (str ‚Üí int/float)
- –ù–µ–≤–µ—Ä–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

**–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:**
- –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (happy path)
- –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (–ø—É—Å—Ç—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏, –ª–∏–º–∏—Ç—ã)
- –ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (—Ä–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏/—á–∞—Ç—ã)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –¢–∏–ø—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- Fallback –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**Async –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- –£—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –û—à–∏–±–∫–∏ API (timeout, connection)
- Side effects (–≤—ã–∑–æ–≤—ã –º–µ—Ç–æ–¥–æ–≤, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è)

## ‚ö†Ô∏è –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–ò–∑–±–µ–≥–∞—Ç—å:**
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- ‚ùå –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ assert –¥–ª—è –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
- ‚ùå –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ —Ç–µ—Å—Ç–∞—Ö (if/for/while)
- ‚ùå –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ magic numbers –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚ùå –¢–µ—Å—Ç—ã –±–µ–∑ docstring

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Ç–µ—Å—Ç—ã
- ‚úÖ Fixtures –¥–ª—è setup/teardown
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ assert —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –û–¥–Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ—Å—Ç

## üöÄ TDD Workflow

1. **Red** - –Ω–∞–ø–∏—Å–∞—Ç—å –ø–∞–¥–∞—é—â–∏–π —Ç–µ—Å—Ç
2. **Green** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
3. **Refactor** - —É–ª—É—á—à–∏—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
make test           # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
make test-cov       # –¢–µ—Å—Ç—ã + coverage (‚â•70%)
make quality        # format + lint + typecheck + test
```

## üìä Coverage

**–¶–µ–ª—å: ‚â•70%**
- –í–∫–ª—é—á–∞–µ–º: –≤—Å–µ –º–æ–¥—É–ª–∏ src/ –∫—Ä–æ–º–µ __init__.py
- –ò—Å–∫–ª—é—á–∞–µ–º: bot startup (bot.py, main.py), Protocol –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –∑–µ–ª–µ–Ω—ã–µ
- [ ] Coverage ‚â• 70%
- [ ] Type hints –≤–æ –≤—Å–µ—Ö —Ç–µ—Å—Ç–∞—Ö
- [ ] Docstrings –æ–±—ä—è—Å–Ω—è—é—Ç —á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã fixtures –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
- [ ] –ú–æ–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [ ] Async —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç AsyncMock
- [ ] –¢–µ—Å—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã
